ganymede_restart:
  alias: "Bedroom Restart"
  sequence:
    - service: switch.turn_off
      entity_id: switch.ganymede
    - delay: '00:00:15'
    - service: switch.turn_on
      entity_id: switch.ganymede

mute_common_room:
  alias: "Mute Common Room"
  sequence:
    - service: broadlink.send_packet_192_168_1_13
      data:
        packet:
          - 'JgDMAG82Dw0PDg0pDg0OKg0ODikPDA4ODikODg8MDikOKQ4ODwwPDQ4NDg4ODw4MDg0OKQ8NDikODw0ODQ4ODg4oDw0ODQ8pDigQKA4ODSsNDQ4NDg4ODQ8oDygPDQ4qDSkOKQ8ODQAJj283DQ4ODQ4pDw0OKQ8MDygQDA8ODSkODQ8NDikOKQ4NDw0ODQ8ODQ4ODwwODwwOKQ8ODSkODQ8NDg0PDg0pDg4ODQ8oDikPKA8NECcPDA8NDg4PDA4rDCkPDg0qDigOKQ4ODwANBQAAAAAAAAAAAAAAAA=='
mute_bedroom:
  alias: "Mute Bedroom"
  sequence:
    - service: broadlink.send_packet_192_168_1_14
      data:
        packet:
          - 'JgDMAAgaCjsKGQkZChkJGgkZCRoJGQk8CTwJPAk8CRkKGQkABZ8KGQk8CxcJGgkZCTwKOwo7CTwJGgkZCRoJGQk8CTwKAAWeChkJPAkZChkJGQoZCRkKGQkZCjsKOwo7CjsKGQkZCgAFnwoYCTwLGAkZCRoJPAk7CjsMOQwXCRkKGQkZCjsKOwwABZ0KGAo7CRoJGQkaCRkJGgkZCRoJPAk8CTwJPAkZCRoJAAWfChgKOwoZCRkKGQk8CTwJPAs6CRkKGQkZChkJPAk8CwANBQAAAAAAAAAAAAAAAA=='
bedroom_ac_24:
  alias: "Bedroom Air Condition 24"
  sequence:
    - service: broadlink.send_packet_192_168_1_14
      data:
        packet:
          - 'JgC8AXA5DyoODg4ODg8NKw4ODg8NDw4ODisODg4rDSsODw0rDisNKw4rDSsPDg0PDioPDg0PDg4ODg4PDQ8OKw0rDyoNKw8NDg8NDw4ODg8NDw4ODg4ODw0PDg4ODw0PDQ8ODg4PDQ8ODg4ODg8NDw4ODg8NDw4ODisODg4ODg4ODw0PDg4OAAPMcTkPKg0PDg4ODg4rDg4ODg4PDQ8OKw0PDioOKw4ODisNKw4rDioPKg4ODg4OKw4ODg8NDw4ODg4ODw0PDg4ODw0PDg4ODg4PDQ8ODg4ODg8NDw4rDg4ODg4ODisOKg8ODQ8ODg4PDQ8ODg4rDSsPDg0PDQ8ODg4PDQ8ODg4ODg8NDw4rDSsPKg4qDg4OKw4ODisOKg8qDioOKw4ODg8NDw4ODg4ODw0PDg4ODw0PDQ8ODg4PDQ8ODg4ODg8NDw4ODg8NDw4ODg4ODw0PDg4ODg4PDQ8ODg4PDQ8ODg4ODg8NDw4ODg4ODw0PDg4ODw0PDg4ODg4PDQ8ODg4ODg8NKw4rDg4ODg4PDQ8ODg4ODg8NDw4ODg8NDw4ODg4ODw0PDg4OKw4ODg4ODw0rDisOKg4rDgANBQAAAAAAAAAAAAAAAA=='
bedroom_ac_21:
  alias: "Bedroom Air Condition 21"
  sequence:
    - service: broadlink.send_packet_192_168_1_14
      data:
        packet:
          - 'JgC8AXE5DioPDQ4PDQ8OKw4ODg4ODg4PDSsPDQ4rDyoNDw4qDyoOKg8qDyoODg4ODisODg4ODg8NDw0PDg4OKw4qDisOKw0PDg4ODg4PDQ8ODg4ODg8NDw4ODg8NDw4ODg4ODw0PDg4ODw0PDQ8ODg4PDQ8ODg4ODisODg4PDQ8NDw4ODg8NAAPNcDkOKw4ODg4ODw0rDg8NDw0PDg4OKw4ODisOKg8ODSsOKw4qDisOKg4PDQ8OKg4PDQ8ODg4PDQ8NDw4ODg8NDw4ODg4ODw0PDg4ODw0PDQ8ODg4rDg4ODg4PDSsOKw0PDg4ODw0rDw0OKw8NDisODg4ODg8NDw4ODg8NDw0PDg4ODw0rDyoNKw8qDQ8OKw0PDioOKw4rDSsPKg4ODg4ODg4PDQ8ODg4PDQ8ODg4ODg8NDw4ODg4ODw0PDg4ODw0PDg4ODg4PDQ8ODg4PDQ8NDw4ODg8NDw4ODg4ODw0PDg4ODw0PDQ8ODg4PDQ8ODg4ODg8NDw4ODg8NDw4ODg4OKw4qDw4NDw4ODg8NDw4ODg4ODw0PDg4ODw0PDQ8ODg4PDQ8OKg4rDg4OKw4ODisNKw8qDgANBQAAAAAAAAAAAAAAAA=='
bedroom_ac_18:
  alias: "Bedroom Air Condition 18"
  sequence:
    - service: broadlink.send_packet_192_168_1_14
      data:
        packet:
          - 'JgC8AXA5DyoODg4ODg8NKw8ODQ8ODg4ODisODg4rDioPDg0rDisOKg4rDioPDg0PDioPDg0PDg4ODw0PDg4OKw0rDyoNKw8ODQ8ODg4ODg8NDw4ODw4NDw0PDg4ODw0PDg4ODg4PDQ8ODg4PDQ8NDw4ODg8NDw4ODisNDw4ODg8NDw4ODg4OAAPMcTkPKg0PDg4ODg4rDg4ODw0PDg4OKw4ODioOKw8NDisOKg8qDioOKw4ODg8NKw4ODg8NDw4ODg8NDw0PDg4ODw0PDg4ODg4PDQ8ODg4PDQ8ODg4rDg4ODg4ODisOKg8ODg4ODg4PDSsODg4PDSsODw0PDg4ODg4PDQ8ODg4PDQ8NDw4rDioPKg4qDw4NKw8NDisOKg4rDyoOKg8NDg8NDw4ODg4ODw0PDg4ODw0PDg4ODg4PDQ8ODg4PDQ8NDw4ODg8NDw4ODg4ODw0PDg4ODw0PDg4ODg4PDQ8ODg4ODg8NDw4ODg8NDw4ODg4ODw0PDg4ODg4PDQ8ODg4PDQ8OKg8qDg4ODg4PDQ8ODg4PDQ8ODg4ODg8NDw4ODg8NDw4ODg4OKw4ODisNDw4ODisOKg8qDgANBQAAAAAAAAAAAAAAAA=='
bedroom_ac_powerful:
  alias: "Bedroom Air Condition Powerful"
  sequence:
    - service: script.bedroom_ac_18
    - delay: 00:00:15
    - service: broadlink.send_packet_192_168_1_14
      data:
        packet:
          - 'JgC8AXE5DioPDQ8ODQ8PKg4ODg4PDQ8ODioODg4rDyoODg4qDyoOKg8qDykPDg4ODisNDw4ODg4ODw0PDw0PKg4qDyoOKg8ODQ8PDQ4PDQ8ODg4ODg8ODg4ODw0PDg4ODw0PDg0PDg4ODg8ODQ8ODg4ODg8NDw8NDisODg4ODw4NDw4ODg4OAAPMcTkPKg0PDg4ODg8qDg4ODw4ODg4OKw4ODioPKg8NDisOKg4rDioPKg8NDw4NKw8NDw4ODg4ODw0ODw4ODw0PDg0PDg4PDQ8ODg4ODg8NDw4ODg4rDg4ODg8NDyoOKg4PDg4PDQ8ODg4OKg8ODSsPDQ8ODg4ODg8ODg4ODg4ODg8NDw4qDyoPKg4qDw0OKw8NDisOKg8qDioPKg8NDw0ODw4ODw0PDg0PDg4ODg8ODg4PDQ4ODw4ODg4ODw4ODg4ODg4PDg4ODw0PDQ4PDg4ODg4PDioPDQ4PDg4ODg4PDQ8ODg8NDw4ODg4ODw0ODw4ODg4PDg4ODQ8PDQ4PDg4OKg8qDw0PDg4ODg4PDQ4PDg4ODg4ODw4ODg8NDw4NDw0PDw0PDg4qDw0PKg8NDisOKg4rDgANBQAAAAAAAAAAAAAAAA=='
    - delay: 00:10:00
    - service: script.bedroom_ac_18
bedroom_ac_control:
  alias: "Bedroom Air Condition Control"
  sequence:
    - service_template: '{% if packet == "24" %}script.bedroom_ac_24{% elif packet == "21" %}script.bedroom_ac_21{% elif packet == "18" %}script.bedroom_ac_18{% elif packet == "powerful" %}script.bedroom_ac_powerful{% else %}{% endif %}'

kodi_play_youtube_playlist:
  alias: "Kodi Play Music DJ"
  sequence:
    - service: media_player.play_media
      data_template:
        entity_id: media_player.kodi
        media_content_id: '{% if playlist != "" %}plugin://plugin.video.youtube/play/?playlist_id={{ playlist }}&order=default&play=1&repeat=all{% endif %}'
        media_content_type: 'video'

kodi_play_music_dj:
  alias: "Kodi Play Music DJ"
  sequence:
    - service: media_player.kodi_call_method
      data:
        entity_id: media_player.kodi
        method: VideoLibrary.Player.SetPartymode
        properties:
          - title
          - year
          - file
          - lastplayed

kodi_update_audio_library:
  alias: Update Kodi Audio Library
  sequence:
    - service: media_player.kodi_call_method
      data:
        entity_id: media_player.kodi
        method: AudioLibrary.Scan
    - delay: 00:01:00
    - service: media_player.kodi_call_method
      data:
        entity_id: media_player.kodi
        method: AudioLibrary.Clean

kodi_update_video_library:
  alias: Update Kodi VDO Library
  sequence:
    - service: media_player.kodi_call_method
      data:
        entity_id: media_player.kodi
        method: VideoLibrary.Scan
    - delay: 00:01:00
    - service: media_player.kodi_call_method
      data:
        entity_id: media_player.kodi
        method: VideoLibrary.Clean

hometheatre_turnon:
  alias: "Home Theatre Turns On"
  sequence:
    - service: switch.turn_on
      entity_id: switch.titan
    - delay: 00:00:05
    - service: switch.turn_on
      entity_id: switch.common_room_tv
    - delay: 00:00:05
    - service: switch.turn_on
      entity_id: switch.common_room_android_box
    - delay: 00:00:05
    - service: script.denon_turnon
    - service: script.switch_to_cabletv

hometheatre_turnoff:
  alias: "Home Theatre Turns Off"
  sequence:
    - service: switch.turn_off
      entity_id: switch.common_room_android_box
    - delay: 00:00:05
    - service: switch.turn_off
      entity_id: switch.mimas
    - delay: 00:00:05
    - service: switch.turn_off
      entity_id: switch.common_room_tv
    - delay: 00:00:05
    - service: script.switch_to_off
    - delay: 00:00:05
    - service: switch.turn_off
      entity_id: switch.titan

switch_to_cabletv:
  alias: "Switch Media to Cable TV"
  sequence:
    - service: script.denon_turnon
    - wait_template: '{{ is_state("script.denon_turnon", "off") }}'
      timeout: 00:00:02
    - condition: template
      # value_template: '{{ not is_state("sensor.denonsourcecheck", "SAT/CBL") }}'
      value_template: '{{ not is_state("sensor.denon_source", "Cable TV") }}'
    - service: shell_command.denon_source_satcbl
    - delay: 00:00:07
    - condition: template
      value_template: '{{ "true" if newvolume != "" else "false" }}'
    - service_template: shell_command.denon_volume_{{ newvolume }}

switch_to_music:
  alias: "Switch Media to Music"
  sequence:
    - service: script.denon_turnon
    - wait_template: '{{ is_state("script.denon_turnon", "off") }}'
      timeout: 00:00:02
    - condition: template
      # value_template: '{{ not is_state("sensor.denonsourcecheck", "Music") }}'
      value_template: '{{ not is_state("sensor.denon_source", "Music") }}'
    - service: shell_command.denon_source_music
    - delay: 00:00:07
    - condition: template
      value_template: '{{ "true" if newvolume != "" else "false" }}'
    - service_template: shell_command.denon_volume_{{ newvolume }}

switch_to_dune:
  alias: "Switch Media to Dune"
  sequence:
    - service: script.denon_turnon
    - wait_template: '{{ is_state("script.denon_turnon", "off") }}'
      timeout: 00:00:02
    - condition: template
      # value_template: '{{ not is_state("sensor.denonsourcecheck", "BD") }}'
      value_template: '{{ not is_state("sensor.denon_source", "Dune") }}'
    - service: shell_command.denon_source_dune
    - delay: 00:00:07
    - condition: template
      value_template: '{{ "true" if newvolume != "" else "false" }}'
    - service_template: shell_command.denon_volume_{{ newvolume }}

switch_to_appletv:
  alias: "Switch Media to Apple TV"
  sequence:
    - service: script.denon_turnon
    - wait_template: '{{ is_state("script.denon_turnon", "off") }}'
      timeout: 00:00:02
    - condition: template
      # value_template: '{{ not is_state("sensor.denonsourcecheck", "MPLAY") }}'
      value_template: '{{ not is_state("sensor.denon_source", "Apple TV") }}'
    - service: shell_command.denon_source_appletv
    - delay: 00:00:07
    - condition: template
      value_template: '{{ "true" if newvolume != "" else "false" }}'
    - service_template: shell_command.denon_volume_{{ newvolume }}

switch_to_off:
  alias: "Switch Media to Off"
  sequence:
    - condition: template
      value_template: '{{ is_state("script.switch_to_off", "off") }}'
    - condition: template
      value_template: '{{ not is_state("sensor.denon_source", "Off") or not is_state("sensor.denonsourcecheck", "") }}'
    - service: media_player.turn_off
      entity_id: media_player.denon
    - delay: 00:00:02
    - service: input_select.select_option
      data:
        entity_id: input_select.denon_mode
        option: 'Off'

denon_turnon:
  alias: "Turn on Denon when it is Off"
  sequence:
    - condition: template
      value_template: '{{ is_state("switch.titan", "on") and is_state("media_player.denon", "off") }}'
    - service: media_player.turn_on
      entity_id: media_player.denon

notify_pesiphone6:
  alias: "Notify iPhone Pe"
  sequence:
    - service: notify.ios_pesiphone6
      data_template:
        title: '{{ title }}'
        message: '{{ message }}'
        data:
          push:
            badge: 1
            category: "ALERT"

notify_juesiphone6splus:
  alias: "Notify iPhone Jue"
  sequence:
    - service: notify.ios_juesiphone6splus
      data_template:
        title: '{{ title }}'
        message: '{{ message }}'
        data:
          push:
            badge: 1
            category: "ALERT"

notify_pesiphone6_juesiphone6splus:
  alias: "Notify iPhone Pe & Jue"
  sequence:
    - service: notify.ios_pesiphone6
      data_template:
        title: '{{ title }}'
        message: '{{ message }}'
        data:
          push:
            badge: 1
            category: "ALERT"
    - service: notify.ios_juesiphone6splus
      data_template:
        title: '{{ title }}'
        message: '{{ message }}'
        data:
          push:
            badge: 1
            category: "ALERT"

flashing_long:
  alias: "Light Flash Long"
  sequence:
    - service: light.turn_on
      entity_id: group.flashlights
      data:
        transition: 1
        brightness: 250
        flash: long

flashing_short:
  alias: "Light Flash Short"
  sequence:
    - service: light.turn_on
      entity_id: group.flashlights
      data:
        transition: 1
        brightness: 250
        flash: short
    - delay: 00:00:01
    - service: light.turn_on
      entity_id: group.flashlights
      data:
        transition: 1
        brightness: 250
        flash: short
    - delay: 00:00:01
    - service: light.turn_on
      entity_id: group.flashlights
      data:
        transition: 1
        brightness: 250
        flash: short
    - delay: 00:00:01
    - service: light.turn_on
      entity_id: group.flashlights
      data:
        transition: 1
        brightness: 250
        flash: short
    - delay: 00:00:01
    - service: light.turn_on
      entity_id: group.flashlights
      data:
        transition: 1
        brightness: 250
        flash: short

flashing_once:
  alias: "Light Flash Once"
  sequence:
    - service: light.turn_on
      entity_id: group.flashlights
      data:
        transition: 1
        brightness: 250
        flash: short

ss_volume_down:
  alias: "Volume Fade Down"
  sequence:
    - condition: template
      value_template: '{{ (is_state("media_player.itunes", "playing") and is_state("input_boolean.mpd_silence", "off")) }}'
    - service: media_player.volume_set
      entity_id: media_player.itunes
      data_template:
        volume_level: '{% if states.media_player.itunes.attributes.volume_level > 0.3 %}{{ states.media_player.itunes.attributes.volume_level - 0.03 }}{% elif states.media_player.itunes.attributes.volume_level < 0.2 %}{{ states.media_player.itunes.attributes.volume_level - 0.01 }}{% else %}{{ states.media_player.itunes.attributes.volume_level - 0.02 }}{% endif %}'
    - service: media_player.volume_set
      entity_id: media_player.itunes
      data_template:
        volume_level: '{% if states.media_player.itunes.attributes.volume_level > 0.3 %}{{ states.media_player.itunes.attributes.volume_level - 0.03 }}{% elif states.media_player.itunes.attributes.volume_level < 0.2 %}{{ states.media_player.itunes.attributes.volume_level - 0.01 }}{% else %}{{ states.media_player.itunes.attributes.volume_level - 0.02 }}{% endif %}'
    - service: media_player.volume_set
      entity_id: media_player.itunes
      data_template:
        volume_level: '{% if states.media_player.itunes.attributes.volume_level > 0.3 %}{{ states.media_player.itunes.attributes.volume_level - 0.03 }}{% elif states.media_player.itunes.attributes.volume_level < 0.2 %}{{ states.media_player.itunes.attributes.volume_level - 0.01 }}{% else %}{{ states.media_player.itunes.attributes.volume_level - 0.02 }}{% endif %}'
    - service: media_player.volume_set
      entity_id: media_player.itunes
      data_template:
        volume_level: '{% if states.media_player.itunes.attributes.volume_level > 0.3 %}{{ states.media_player.itunes.attributes.volume_level - 0.03 }}{% elif states.media_player.itunes.attributes.volume_level < 0.2 %}{{ states.media_player.itunes.attributes.volume_level - 0.01 }}{% else %}{{ states.media_player.itunes.attributes.volume_level - 0.02 }}{% endif %}'
    - service: media_player.volume_set
      entity_id: media_player.itunes
      data_template:
        volume_level: '{% if states.media_player.itunes.attributes.volume_level > 0.3 %}{{ states.media_player.itunes.attributes.volume_level - 0.03 }}{% elif states.media_player.itunes.attributes.volume_level < 0.2 %}{{ states.media_player.itunes.attributes.volume_level - 0.01 }}{% else %}{{ states.media_player.itunes.attributes.volume_level - 0.02 }}{% endif %}'
    - service: media_player.volume_set
      entity_id: media_player.itunes
      data_template:
        volume_level: '{% if states.media_player.itunes.attributes.volume_level > 0.3 %}{{ states.media_player.itunes.attributes.volume_level - 0.03 }}{% elif states.media_player.itunes.attributes.volume_level < 0.2 %}{{ states.media_player.itunes.attributes.volume_level - 0.01 }}{% else %}{{ states.media_player.itunes.attributes.volume_level - 0.02 }}{% endif %}'
    - service: media_player.volume_set
      entity_id: media_player.itunes
      data_template:
        volume_level: '{% if states.media_player.itunes.attributes.volume_level > 0.3 %}{{ states.media_player.itunes.attributes.volume_level - 0.03 }}{% elif states.media_player.itunes.attributes.volume_level < 0.2 %}{{ states.media_player.itunes.attributes.volume_level - 0.01 }}{% else %}{{ states.media_player.itunes.attributes.volume_level - 0.02 }}{% endif %}'

ss_volume_up:
  alias: "Volume Fade Up"
  sequence:
    - condition: template
      value_template: '{{ (is_state("media_player.itunes", "playing") and is_state("input_boolean.mpd_silence", "off")) }}'
    - service: media_player.volume_set
      entity_id: media_player.itunes
      data_template:
        volume_level: '{% if states.media_player.itunes.attributes.volume_level > 0.3 %}{{ states.media_player.itunes.attributes.volume_level + 0.03 }}{% elif states.media_player.itunes.attributes.volume_level < 0.2 %}{{ states.media_player.itunes.attributes.volume_level + 0.01 }}{% else %}{{ states.media_player.itunes.attributes.volume_level + 0.02 }}{% endif %}'
    - service: media_player.volume_set
      entity_id: media_player.itunes
      data_template:
        volume_level: '{% if states.media_player.itunes.attributes.volume_level > 0.3 %}{{ states.media_player.itunes.attributes.volume_level + 0.03 }}{% elif states.media_player.itunes.attributes.volume_level < 0.2 %}{{ states.media_player.itunes.attributes.volume_level + 0.01 }}{% else %}{{ states.media_player.itunes.attributes.volume_level + 0.02 }}{% endif %}'
    - service: media_player.volume_set
      entity_id: media_player.itunes
      data_template:
        volume_level: '{% if states.media_player.itunes.attributes.volume_level > 0.3 %}{{ states.media_player.itunes.attributes.volume_level + 0.03 }}{% elif states.media_player.itunes.attributes.volume_level < 0.2 %}{{ states.media_player.itunes.attributes.volume_level + 0.01 }}{% else %}{{ states.media_player.itunes.attributes.volume_level + 0.02 }}{% endif %}'
    - service: media_player.volume_set
      entity_id: media_player.itunes
      data_template:
        volume_level: '{% if states.media_player.itunes.attributes.volume_level > 0.3 %}{{ states.media_player.itunes.attributes.volume_level + 0.03 }}{% elif states.media_player.itunes.attributes.volume_level < 0.2 %}{{ states.media_player.itunes.attributes.volume_level + 0.01 }}{% else %}{{ states.media_player.itunes.attributes.volume_level + 0.02 }}{% endif %}'
    - service: media_player.volume_set
      entity_id: media_player.itunes
      data_template:
        volume_level: '{% if states.media_player.itunes.attributes.volume_level > 0.3 %}{{ states.media_player.itunes.attributes.volume_level + 0.03 }}{% elif states.media_player.itunes.attributes.volume_level < 0.2 %}{{ states.media_player.itunes.attributes.volume_level + 0.01 }}{% else %}{{ states.media_player.itunes.attributes.volume_level + 0.02 }}{% endif %}'
    - service: media_player.volume_set
      entity_id: media_player.itunes
      data_template:
        volume_level: '{% if states.media_player.itunes.attributes.volume_level > 0.3 %}{{ states.media_player.itunes.attributes.volume_level + 0.03 }}{% elif states.media_player.itunes.attributes.volume_level < 0.2 %}{{ states.media_player.itunes.attributes.volume_level + 0.01 }}{% else %}{{ states.media_player.itunes.attributes.volume_level + 0.02 }}{% endif %}'
    - service: media_player.volume_set
      entity_id: media_player.itunes
      data_template:
        volume_level: '{% if states.media_player.itunes.attributes.volume_level > 0.3 %}{{ states.media_player.itunes.attributes.volume_level + 0.03 }}{% elif states.media_player.itunes.attributes.volume_level < 0.2 %}{{ states.media_player.itunes.attributes.volume_level + 0.01 }}{% else %}{{ states.media_player.itunes.attributes.volume_level + 0.02 }}{% endif %}'

s_speak:
  alias: "Sub-notify script Speak"
  sequence:
    - condition: template
      value_template: '{{ speak != "false" and is_state("device_tracker.pepe", "home") }}'
    - service: script.ss_volume_down
    - service: media_player.volume_set
      data_template:
        entity_id: media_player.music_player_daemon
        volume_level: '{% if is_state("input_boolean.mpd_silence", "on") %}0.0{% else %}1.0{% endif%}'
    - service: media_player.play_media
      data_template:
        entity_id: media_player.music_player_daemon
        media_content_id: '{% if audio == "pip "%}http://phumin.synology.me:7575/local/sounds/pip.mp3{% elif audio == "horn" %}http://phumin.synology.me:7575/local/sounds/horn.mp3{% elif audio == "siren" %}http://phumin.synology.me:7575/local/sounds/siren.mp3{% elif audio == "chime" %}http://phumin.synology.me:7575/local/sounds/chime.mp3{% else %}http://phumin.synology.me:7575/local/sounds/sinewave.mp3{% endif %}'
        media_content_type: "audio/mp3"
    - delay: 00:00:01
    - service: tts.google_say
      data_template:
        entity_id: media_player.music_player_daemon
        message: "{{ title }} {{ now().strftime('%H:%M') }}"
    - delay: 00:00:03
    - service: script.ss_volume_up

s_email:
  alias: "Sub-notify script Email"
  sequence:
    - condition: template
      value_template: '{{ email != "false" }}'
    - service: notify.email
      data_template:
        title: '{{ title }}'
        message: '{{ message }}'

s_mbp:
  alias: "Sub-notify script Macbook Pro"
  sequence:
    - condition: template
      value_template: '{{ is_state("device_tracker.pepe", "home") or is_state("binary_sensor.pepe", "on") }}'
    - service: notify.growl
      data_template:
        title: '{{ title }}'
        message: '{{ message }}'

s_tv:
  alias: "Sub-notify script TV"
  sequence:
    - condition: template
      value_template: '{{ tv != "false" and is_state("media_player.denon", "on") }}'
    - service: notify.tv
      data_template:
        title: '{{ title }}'
        message: '{{ message }}'

s_mobile:
  alias: "Sub-notify script Mobile"
  sequence:
    - condition: template
      value_template: '{{ mobile != "false" }}'
    - service_template: '{% if mobile == "pe" %}script.notify_pesiphone6{% elif mobile == "jue" %}script.notify_juesiphone6splus{% elif mobile == "both" %}script.notify_pesiphone6_juesiphone6splus{% else %}script.notify_pesiphone6{% endif %}'
      data_template:
        title: '{{ title }}'
        message: '{{ message }}'

s_light:
  alias: "Sub-notify script Light"
  sequence:
    - condition: template
      value_template: '{{ light != "false" }}'
    - service_template: '{% if light == "long" %}script.flashing_long{% elif light == "short" %}script.flashing_short{% elif light == "once" %}script.flashing_once{% endif %}'

notifying:
  alias: "Notify script"
  sequence:
    - condition: template
      value_template: '{{ is_state("script.notifying", "off") }}'
    - service: script.s_mbp
      data_template:
        title: '{{ title }}'
        message: '{{ message }}'
    - service: script.s_light
      data_template:
        light: '{{ light if (light == "long" or light == "short" or light == "once" or light == "false") else "false" }}'
    - delay: 00:00:02
    - service: script.s_email
      data_template:
        email: '{{ email if (email == "true" or email == "false") else "true" }}'
        title: '{{ title }}'
        message: '{{ message }}'
    - service: script.s_tv
      data_template:
        tv: '{{ tv if (tv == "true" or tv == "false") else "true" }}'
        title: '{{ title }}'
        message: '{{ message }}'
    - service: script.s_speak
      data_template:
        speak: '{{ speak if (speak == "true" or speak == "false") else "true" }}'
        audio: '{{ audio if (audio == "siren" or audio == "pip" or audio == "chime" or audio == "horn" or audio == "sinewave") else "sinewave" }}'
        title: '{{ title }}'
        message: '{{ message }}'
    - service: script.s_mobile
      data_template:
        mobile: '{{ mobile if (mobile == "pe" or mobile == "jue" or mobile == "both" or mobile == "false") else "false" }}'
        title: '{{ title }}'
        message: '{{ message }}'
