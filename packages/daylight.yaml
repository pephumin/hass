sensor:
  - platform: moon
  - platform: time_date
    name: Date & Time
    display_options:
      - 'time'
      - 'date'
  - platform: template
    sensors:
      solar_angle:
        friendly_name: 'Sun Angle'
        icon_template: mdi:weather-sunset
        value_template: '{{ "%+.1f"|format(states.sun.sun.attributes.elevation) }}'
        unit_of_measurement: 'Â°'
      sunrise:
        value_template: "{{ states.sun.sun.attributes.next_rising }}"
  # - platform: season
  #   type: astronomical

automation:

  - alias: "Sunset 1"
    trigger:
      - platform: sun
        event: sunset
        offset: "-00:30:00"
    condition:
      - condition: template
        value_template: '{{ is_state("input_select.homemode", "Home") and is_state("input_boolean.presence_pe", "on") }}'
    action:
      - service: script.notifying
        data:
          email: "false"
          tv: "true"
          speak: "false"
          audio: "pip"
          light: "false"
          mobile: "false"
          title: "Sunset is expected in 30 minutes"
          message: 'Sunset is expected in 30 minutes [{{now().strftime("%d.%m.%y")}} {{now().strftime("%H:%M")}}]'

  - alias: "Sunset 2"
    trigger:
      - platform: sun
        event: sunset
        offset: "+00:00:00"
    condition:
      - condition: template
        value_template: '{{ is_state("input_select.homemode", "Home") and is_state("input_boolean.presence_pe", "on") }}'
    action:
      - service: script.notifying
        data:
          email: "false"
          tv: "true"
          speak: "false"
          audio: "pip"
          light: "false"
          mobile: "false"
          title: "Sun is setting now"
          message: 'Sun is setting now [{{now().strftime("%d.%m.%y")}} {{now().strftime("%H:%M")}}]'

  # - alias: "Theme Start Up"
  #   initial_state: 'on'
  #   trigger:
  #     - platform: homeassistant
  #       event: start
  #   action:
  #     - service: frontend.set_theme
  #       data_template:
  #         name: '{% if is_state("sun.sun", "above_horizon") %}green{% else %}darkgreen{% endif %}'
  #
  # - alias: "Theme Day Time"
  #   trigger:
  #     - platform: sun
  #       event: sunrise
  #   action:
  #     - service: frontend.set_theme
  #       data:
  #         name: 'blue'
  #
  # - alias: "Theme Night Time"
  #   trigger:
  #     - platform: sun
  #       event: sunset
  #   action:
  #     - service: frontend.set_theme
  #       data:
  #         name: 'darkblue'
