light:
  - platform: mqtt
    schema: json
    name: "Party"
    command_topic: "party/setpower"
    state_topic: "party/powerstate"
    # rgb_state_topic: "party/colorstate"
    # rgb_command_topic: "party/setcolor"
    # brightness_state_topic: "party/brightnessstate"
    # brightness_command_topic: "party/setbrightness"
    qos: 1
    # flash_time_long: 15
    # flash_time_short: 5
    brightness: true
    color_temp: true
    rgb: true
    optimistic: false
    white_value: false
    xy: false
    hs: false
    retain: true
    unique_id: 2f045cab-513e-4e0d-8233-fee82a265e1c

input_select:
  party_effect:
    name: "Party LED Effect"
    options:
      - BPM
      - Candy Cane
      - Christmas
      - Confetti
      - Cyclon Rainbow
      - Dots
      - Easter
      - Fire
      - Glitter
      - Go Blue
      - Hail
      - Halloween
      - Holly Jolly
      - Independence
      - Juggle
      - Lightning
      - Lovey Day
      - Police All
      - Police One
      - Punkin
      - Rainbow
      - Rainbow with Glitter
      - Ripple
      - St Patty
      - Sinelon
      - Solid
      - Thanksgiving
      - Touchdown
      - Turkey Day
      - Twinkle
      - USA
      - Valentine
    initial: "Solid"

input_number:
  party_animation_speed:
    name: "Animation Speed"
    initial: 100
    min: 1
    max: 150
    step: 10

group:
  party:
    name: "Party Light"
    icon: mdi:led-strip
    view: false
    control: hidden
    entities:
      - light.party
      - input_select.party_effect
      - input_number.party_animation_speed

automation old:

  - alias: "Party LED Effect"
    initial_state: "on"
    hide_entity: false
    trigger:
      - platform: state
        entity_id: input_select.party_effect
    action:
      - service: mqtt.publish
        data_template:
          topic: "party/seteffect"
          payload: '{{ trigger.to_state.state | string }}'

  - alias: "LED Animation Speed"
    initial_state: "on"
    hide_entity: false
    trigger:
      - platform: state
        entity_id: input_number.party_animation_speed
    action:
      - service: mqtt.publish
        data_template:
          topic: "party/setanimationspeed"
          payload: '{{ trigger.to_state.state | int }}'

  - alias: "Set LED Animation Speed"
    initial_state: "on"
    trigger:
      - platform: mqtt
        topic: "party/setanimationspeed"
    action:
      - service: input_number.set_value
        data_template:
          entity_id: input_number.party_animation_speed
          value: '{{ trigger.payload }}'

  - alias: "Party LED Sunset Rotation"
    initial_state: "on"
    hide_entity: true
    trigger:
      - platform: sun
        event: sunset
    condition:
      - condition: template
        value_template: '{{ now().month == 12 }}'
    action:
      - service: mqtt.publish
        data:
          topic: "bruh/mqttstrip/seteffect"
          payload: 'Holly Jolly'
      - delay: 01:00:00
      - service: mqtt.publish
        data:
          topic: "bruh/mqttstrip/seteffect"
          payload: 'Candy Cane'
      - delay: 01:00:00
      - service: mqtt.publish
        data:
          topic: "bruh/mqttstrip/seteffect"
          payload: 'Christmas'
      - delay: 01:00:00
      - service: mqtt.publish
        data:
          topic: "bruh/mqttstrip/seteffect"
          payload: 'Holly Jolly'

#   - alias: "Party Brightness Control mqtt"
#     trigger:
#       - platform: mqtt
#         topic: "party"
#         # Optional
#         # payload: "on"
#     action:
#       - service_template: light.turn_{{ trigger.payload_json.action }}
#         data_template:
#           entity_id: light.{{ trigger.payload_json.device }}
#           brightness: '{{ trigger.payload_json.brightness }}'
#
# {
# 	"device": "party ",
# 	"action": "on",
# 	"brightness": 30
# }

# Fade the Light On Over 5 Seconds - light.turn_on
#
# {
# 	"entity_id": "light.party",
# 	"brightness": 150,
# 	"color_name": "blue",
# 	"transition": "5"
# }
#
# Flash The Light - light.turn_on
#
# {
# 	"entity_id": "light.party",
# 	"color_name": "green",
# 	"brightness": 255,
# 	"flash": "short"
# }
#
# Call Rainbow Effect with Slow Animation Speed - light.turn_on
#
# {
# 	"entity_id": "light.party",
# 	"transition": "50",
# 	"brightness": 255,
# 	"effect": "rainbow"
# }
#
# Fade the Light Off Over 5 Seconds - light.turn_off
#
# {
# 	"entity_id": "light.party",
# 	"transition": "50"
# }
